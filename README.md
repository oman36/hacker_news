# hacker_news
## Настройки
Если вы будете что-то менять в настройках, то для этого есть `env_settings.py` 
в нём вым можете пребить настройки поумолчанию из [/hackernews/settings.py](/hackernews/settings.py)
### Хост
Если вы будете использовать хост отличный от `0.0.0.0`, то вам необходимо указать:

```py
ALLOWED_HOSTS = ['ВАШ_ХОСТ']
```

### База данных
Если вы хотите указать свою базу например на **Mysql** вам необходим указать следующие:

```py
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.mysql',
        'HOST': 'ХОСТ_НА_КОТОРОМ_БАЗА_ДАННЫХ',
        'USER': 'ПОЛЬЗОВАТЕЛЬ',
        'PASSWORD': 'ПАРОЛЬ',
        'NAME': 'НАЗВАНИЕ_БАЗЫ_ДАННЫХ_ИЛИ_СХЕМЫ',
        'PORT': 'ПОРТ_КОТОРЫЙ_СЛУШАЕТ_БАЗА_ДАННЫХ', 
    }
}
```

## Запуск 
### Docker
Запуск сервера:

```console
docker-compose up -d
```

Сервер начнёт слушать 8000 порт.
Миграции автоматически не накатываются, поэтому после первого запуска или после смены БД вам понадобиться выполнить:

```console
docker-compose exec hacker_news python manage.py migrate
```

Что бы выполнить запрос за новостями необходимо выполнить следующую команду:

```console
docker-compose exec hacker_news python manage.py fetch_hacker_news
```

Для крона команда `cd РАБОЧАЯ_ДИРЕКТОРИЯ && /usr/local/bin/docker-compose exec -T python python manage.py fetch_hacker_news`,
где `РАБОЧАЯ_ДИРЕКТОРИЯ` это абсолютный адрес до `docker-compose.yml` в директирии с проектом. 

### Без докера
Команды выпонляются из директрории с проектом!
Запуск сервера:

```console
python3 manage.py runserver 0.0.0.0:8000
```

Сервер начнёт слушать 8000 порт.
Миграции автоматически не накатываются, поэтому после первого запуска или после смены БД вам понадобиться выполнить:

```console
python3 manage.py migrate
```

Что бы выполнить запрос за новостями необходимо выполнить следующую команду:

```console
python manage.py fetch_hacker_news
```

Для крона команда `/usr/bin/env python3 РАБОЧАЯ_ДИРЕКТОРИЯ/manage.py fetch_hacker_news`,
где `РАБОЧАЯ_ДИРЕКТОРИЯ` это абсолютный адрес до директрории с проектом. 

